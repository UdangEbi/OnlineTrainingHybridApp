<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <title>OnlineTrainingHybridApp</title>
    <base href="/" />
    <link rel="stylesheet" href="_content/OnlineTrainingHybridApp.Shared/bootstrap/bootstrap.min.css" />
    <link rel="stylesheet" href="_content/OnlineTrainingHybridApp.Shared/app.css" />
    <link rel="stylesheet" href="app.css" />
    <link rel="stylesheet" href="OnlineTrainingHybridApp.styles.css" />
    <link rel="icon" href="data:,">
</head>

<body>

    <div class="status-bar-safe-area"></div>

    <div id="app">Loading...</div>

    <script src="_framework/blazor.webview.js" autostart="false"></script>
    <script>
        window.cameraCapture = {
            stream: null,

            start: async function (videoElementId) {
                try {
                    const video = document.getElementById(videoElementId);
                    if (!video) {
                        console.error("Video element not found:", videoElementId);
                        return;
                    }

                    const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                    this.stream = stream;
                    video.srcObject = stream;
                    await video.play();
                } catch (err) {
                    console.error("Error starting camera:", err);
                    alert("Tidak bisa mengakses kamera: " + err);
                }
            },

            stop: function (videoElementId) {
                const video = document.getElementById(videoElementId);
                if (video && video.srcObject) {
                    const tracks = video.srcObject.getTracks();
                    tracks.forEach(t => t.stop());
                    video.srcObject = null;
                }
            },

            takePhoto: function (videoElementId, canvasElementId) {
                const video = document.getElementById(videoElementId);
                const canvas = document.getElementById(canvasElementId);
                if (!video || !canvas) {
                    console.error("Video/canvas element not found");
                    return null;
                }

                const width = video.videoWidth;
                const height = video.videoHeight;
                canvas.width = width;
                canvas.height = height;

                const ctx = canvas.getContext("2d");
                ctx.drawImage(video, 0, 0, width, height);

                // Kembalikan data URL base64 (image/png)
                return canvas.toDataURL("image/png");
            }
        };
    </script>


</body>

</html>